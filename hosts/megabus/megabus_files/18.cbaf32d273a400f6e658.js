(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{BDMH:function(n,t,l){"use strict";l.r(t);var e=l("CcnG"),o=l("ZYCi"),i=l("mvnO"),u=l("jl4g"),r=function(){function n(n,t){this.coreService=n,this.router=t,this.hideCreditAmount=!1}return n.prototype.ngOnInit=function(){var n=this;this.subBasket=this.coreService.basket$.subscribe(function(t){n.creditAmount=n.determineCreditAmount(t),n.updateBodyClass()}),this.subRouterEvents=this.router.events.subscribe(function(t){var l=t instanceof o.d&&t.url||"";n.hideCreditAmount=l.includes("/journey-planner/basket")||l.includes("/journey-planner/confirmation"),n.updateBodyClass()})},n.prototype.ngOnDestroy=function(){this.subRouterEvents.unsubscribe(),this.subBasket.unsubscribe()},n.prototype.updateBodyClass=function(){this.hideCreditAmount||void 0==this.creditAmount?document.body.classList.add("credit-shown"):document.body.classList.remove("credit-shown")},n.prototype.determineCreditAmount=function(n){if(n&&n.basketKind===u.a.AMENDMENT)return n.cancelledTotal-n.applicableCreditTotal},n}(),a=function(){function n(){}return n.entry=r,n}(),c=l("pMnS"),s=l("t68o"),d=l("o3x0"),b=function(){},p=e.Na({encapsulation:2,styles:[],data:{}});function f(n){return e.jb(0,[(n()(),e.Pa(0,0,null,null,5,"h4",[["class","mat-dialog-title"],["mat-dialog-title",""]],[[8,"id",0]],null,null,null,null)),e.Oa(1,81920,null,0,d.m,[[2,d.l],e.k,d.e],null,null),(n()(),e.hb(-1,null,[" Time's up! "])),(n()(),e.Pa(3,0,null,null,2,"button",[["aria-hidden","true"],["class","dialog-close"],["mat-dialog-close",""],["type","button"]],[[1,"aria-label",0]],[[null,"click"]],function(n,t,l){var o=!0;return"click"===t&&(o=!1!==e.Za(n,4).dialogRef.close(e.Za(n,4).dialogResult)&&o),o},null,null)),e.Oa(4,606208,null,0,d.g,[[2,d.l],e.k,d.e],{dialogResult:[0,"dialogResult"]},null),(n()(),e.hb(-1,null,["Close"])),(n()(),e.Pa(6,0,null,null,3,"mat-dialog-content",[["class","mat-dialog-content"]],null,null,null,null,null)),e.Oa(7,16384,null,0,d.j,[],null,null),(n()(),e.Pa(8,0,null,null,1,"p",[],null,null,null,null,null)),(n()(),e.hb(-1,null,["Sorry - time's up. The time limit gives others a chance to buy tickets. You can try again for the same tickets."]))],function(n,t){n(t,1,0),n(t,4,0,"")},function(n,t){n(t,0,0,e.Za(t,1).id),n(t,3,0,e.Za(t,4).ariaLabel)})}var m=e.La("ng-component",b,function(n){return e.jb(0,[(n()(),e.Pa(0,0,null,null,1,"ng-component",[],null,null,null,f,p)),e.Oa(1,49152,null,0,b,[],null,null)],null,null)},{},{},[]),h=l("TrSq"),g=l("Ip0R"),k=function(){function n(){}return n.prototype.transform=function(n){if(void 0==n||n<0)return"0:00";var t=Math.floor(n/60).toString(),l=(n%60).toString();return 1==l.length&&(l="0"+l),t+":"+l},n}(),y=l("doIz"),v=function(){function n(n){this.document=n}return n.prototype.toHomePage=function(){this.toUrl("/")},n.prototype.toUrl=function(n){this.document.location.assign(n)},n.ngInjectableDef=e.S({factory:function(){return new n(e.W(g.e))},token:n,providedIn:"root"}),n}(),S=function(){function n(n,t,l,e,o){this.timerService=n,this.coreService=t,this.router=l,this.modalService=e,this.navigationService=o,this.warnThreshold=60,this.basketTimerEnabled=this.coreService.features.isEnabled.basketTimerVisible}return n.prototype.ngOnInit=function(){var n=this;this.onTimeoutSubscription=this.timerService.onTimeout.subscribe(function(t){return n.onTimeout()}),this.timeLeftSubscription=this.timerService.timeLeft$.subscribe(function(t){n.updateProperties(t)}),this.routerEventSubscription=this.router.events.subscribe(function(t){t instanceof o.d&&n.updateProperties(n.timerService.timeLeft$.value)})},n.prototype.updateProperties=function(n){this.basketTimerEnabled&&n&&this.onStockTimerPage()?(document.body.classList.add("countdown-shown"),this.timeLeft=n):(document.body.classList.remove("countdown-shown"),this.timeLeft=void 0),this.state=n<=this.warnThreshold?"warn":"good",this.progressPercent=n<=this.warnThreshold?Math.round(n/this.warnThreshold*100):100},n.prototype.onTimeout=function(){var n=this;this.modalService.open(b).afterClosed().subscribe(function(){n.router.url.includes("/journey-planner/payment")?n.router.navigateByUrl("/journey-planner/basket"):n.navigationService.toHomePage()})},n.prototype.onStockTimerPage=function(){return this.router.url.includes("/journey-planner/payment")||this.router.url.includes("/journey-planner/basket")},n.prototype.ngOnDestroy=function(){this.onTimeoutSubscription.unsubscribe(),this.timeLeftSubscription.unsubscribe(),this.routerEventSubscription.unsubscribe()},n}(),w=e.Na({encapsulation:2,styles:[[".stock-timer{background:#37b880;color:#fff;bottom:0;position:fixed;z-index:999;width:100%;font-weight:700;text-align:center;transition:background-color 1s}.stock-timer__content{padding:10px 0;text-align:center}.basket .stock-timer,.billing .stock-timer{bottom:52px}@media only screen and (min-width:768px){.basket .stock-timer,.billing .stock-timer{bottom:0}}@media only screen and (max-width:991px){.keyboard-active .stock-timer{position:absolute}}[class*=percent-9]{background-color:#e25f68}[class*=percent-8]{background-color:#e15a64}[class*=percent-7]{background-color:#e1565f}[class*=percent-6]{background-color:#e0525b}[class*=percent-5]{background-color:#df4d57}[class*=percent-4]{background-color:#de4953}[class*=percent-3]{background-color:#de454f}[class*=percent-2]{background-color:#dd404b}[class*=percent-1]{background-color:#dc3c47}[class*=percent-100]{background:#37b880}"]],data:{}});function P(n){return e.jb(0,[(n()(),e.Pa(0,0,null,null,5,"div",[],[[8,"className",0]],null,null,null,null)),e.db(1,1),(n()(),e.Pa(2,0,null,null,3,"div",[["class","container"]],null,null,null,null,null)),(n()(),e.Pa(3,0,null,null,2,"div",[["class","stock-timer__content"]],null,null,null,null,null)),(n()(),e.hb(4,null,[" "," to complete booking "])),e.db(5,1)],null,function(n,t){var l=t.component;n(t,0,0,e.Ra(2,"stock-timer stock-timer__percent-",e.ib(t,0,0,n(t,1,0,e.Za(t.parent,0),l.progressPercent))," stock-timer__state-",l.state,"")),n(t,4,0,e.ib(t,4,0,n(t,5,0,e.Za(t.parent,1),l.timeLeft)))})}function T(n){return e.jb(0,[e.bb(0,g.f,[e.t]),e.bb(0,k,[]),(n()(),e.Ga(16777216,null,null,1,null,P)),e.Oa(3,16384,null,0,g.m,[e.O,e.L],{ngIf:[0,"ngIf"]},null)],function(n,t){n(t,3,0,t.component.timeLeft)},null)}var X=e.Na({encapsulation:2,styles:[[".credit-sticky{background:#005;border-top:1px solid #00003b;color:#fff;position:fixed;bottom:0;z-index:999;width:100%}.credit-sticky__content{padding:10px 0;text-align:right}.credit-sticky__text{margin-right:10px}.credit-sticky__price{font-weight:700;font-size:20px}"]],data:{}});function j(n){return e.jb(0,[(n()(),e.Pa(0,0,null,null,7,"div",[["class","credit-sticky"]],null,null,null,null,null)),(n()(),e.Pa(1,0,null,null,6,"div",[["class","container"]],null,null,null,null,null)),(n()(),e.Pa(2,0,null,null,5,"div",[["class","credit-sticky__content"]],null,null,null,null,null)),(n()(),e.Pa(3,0,null,null,1,"span",[["class","credit-sticky__text"]],null,null,null,null,null)),(n()(),e.hb(-1,null,["Total credit:"])),(n()(),e.Pa(5,0,null,null,2,"span",[["class","credit-sticky__price"]],null,null,null,null,null)),(n()(),e.hb(6,null,["",""])),e.db(7,1)],null,function(n,t){var l=t.component;n(t,6,0,e.ib(t,6,0,n(t,7,0,e.Za(t.parent,0),l.creditAmount)))})}function _(n){return e.jb(0,[e.bb(0,h.a,[i.a]),(n()(),e.Pa(1,0,null,null,1,"mb-stock-timer",[],null,null,null,T,w)),e.Oa(2,245760,null,0,S,[y.a,i.a,o.l,d.e,v],null,null),(n()(),e.Ga(16777216,null,null,1,null,j)),e.Oa(4,16384,null,0,g.m,[e.O,e.L],{ngIf:[0,"ngIf"]},null)],function(n,t){var l=t.component;n(t,2,0),n(t,4,0,!l.hideCreditAmount&&void 0!=l.creditAmount)},null)}var x=e.La("mb-sticky-footer",r,function(n){return e.jb(0,[(n()(),e.Pa(0,0,null,null,1,"mb-sticky-footer",[],null,null,null,_,X)),e.Oa(1,245760,null,0,r,[i.a,o.l],null,null)],function(n,t){n(t,1,0)},null)},{},{},[]),L=l("gIcY"),O=l("eDkP"),C=l("Fzqc"),A=l("2Tgv"),I=l("hqF2"),B=l("4c35"),E=l("dWZg"),Z=l("qAlS"),M=l("Wf4p"),R=function(){};l.d(t,"StickyFooterModuleNgFactory",function(){return N});var N=e.Ma(a,[],function(n){return e.Wa([e.Xa(512,e.j,e.Ba,[[8,[c.a,s.a,m,x]],[3,e.j],e.w]),e.Xa(4608,g.o,g.n,[e.t,[2,g.w]]),e.Xa(4608,L.B,L.B,[]),e.Xa(4608,O.a,O.a,[O.g,O.c,e.j,O.f,O.d,e.q,e.y,g.e,C.b]),e.Xa(5120,O.h,O.i,[O.a]),e.Xa(5120,d.c,d.d,[O.a]),e.Xa(4608,d.e,d.e,[O.a,e.q,[2,g.i],[2,d.b],d.c,[3,d.e],O.c]),e.Xa(1073742336,g.c,g.c,[]),e.Xa(1073742336,L.y,L.y,[]),e.Xa(1073742336,L.j,L.j,[]),e.Xa(1073742336,o.o,o.o,[[2,o.u],[2,o.l]]),e.Xa(1073742336,A.a,A.a,[]),e.Xa(1073742336,I.a,I.a,[]),e.Xa(1073742336,C.a,C.a,[]),e.Xa(1073742336,B.f,B.f,[]),e.Xa(1073742336,E.b,E.b,[]),e.Xa(1073742336,Z.a,Z.a,[]),e.Xa(1073742336,O.e,O.e,[]),e.Xa(1073742336,M.i,M.i,[[2,M.c]]),e.Xa(1073742336,d.k,d.k,[]),e.Xa(1073742336,R,R,[]),e.Xa(1073742336,a,a,[])])})}}]);